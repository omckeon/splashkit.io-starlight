---
import { LinkCard, CardGrid } from "@astrojs/starlight/components";

interface Frontmatter {
  title: string;
  description?: string;
}

// Load and filter posts
let posts = await Astro.glob<Frontmatter>(
  "../content/docs/usage-examples/*.mdx"
);
posts = posts.filter((post) => !post.file.endsWith("index.mdx"));
posts = posts.filter((post) => !post.file.endsWith("CONTRIBUTING.mdx"));

// Function to simplify file path
function simplifyFilePath(filePath: string): string {
  filePath = filePath.replace(/^\/|\/$/g, "");
  const pathParts = filePath.split("/");
  const fileFolder = pathParts[pathParts.length - 2];
  const lastPart = pathParts[pathParts.length - 1];
  const simplifiedName =
    fileFolder + "/" + lastPart.split(".").slice(0, -1).join(".");
  return simplifiedName.toLowerCase();
}
---

<CardGrid>
  {
    posts.map((post) => (
      <LinkCard
        title={post.frontmatter.title}
        description={post.frontmatter.description}
        href={simplifyFilePath(post.url?.toString() || "")}
      />
    ))
  }
</CardGrid>
